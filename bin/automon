#!/bin/bash

(optimus-manager --print-mode | grep -q 'nvidia') || exit 1

xrandr | grep -q 'HDMI-0 connected'
if [ $? -eq 0 ]
then
    # HDMI connected
    EDID=$(cat /sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0/drm/card1/card1-HDMI-A-1/edid | parse-edid 2>/dev/null)
    MONITOR=$(awk '$1=="Identifier" { gsub("\"", "", $2); print $2 }' <<< $EDID)

    case "$MONITOR" in
        "PL2480H")
            xrandr --output HDMI-0 --auto --output eDP-1-1 --auto --right-of HDMI-0
            ;;
    esac

    exit 0
fi
